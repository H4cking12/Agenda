<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <title>Agenda de Contactos</title>
</head>
<body class="fondo">
<div class="container fondo">
    <img src="" alt="" srcset="">
    <h1 class="text-center p-4 p-4">Agenda de Contactos</h1>
    <div class="row mb-3">
        <div class="col-2 offset-10 text-end">
            <button type="button" class="btn btn-primary w-50" data-bs-toggle="modal" data-bs-target="#modalUsuario"
                    id="botoncrear">
                <i class="bi bi-person-vcard-fill"> Crear</i>
            </button>
        </div>
    </div>
        <div class="table-responsive">
            <table class="table table-bordered">
                <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Imagen</th>
                    <th scope="col">Nombre</th>
                    <th scope="col">Apellido</th>
                    <th scope="col">Cedula</th>
                    <th scope="col">Telefono</th>
                    <th scope="col">Correo</th>
                    <th scope="col">Redes</th>
                    <th scope="col">Comentario</th>
                    <th scope="col"></th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <th scope="row">1</th>
                    <td><img src="/img/hola.jpg" alt="" width="40" height="40"></td>
                    <td>Mark</td>
                    <td>Otto</td>
                    <td>402-4106071-0</td>
                    <td>829-901-0538</td>
                    <td>mark@gmail.com</td>
                    <td>@markotto</td>
                    <td>Sin comentario</td>
                    <td>
                        <a href="#" class="btn btn-success btn-sm"><i class="bi bi-file-earmark-diff-fill"></i></a>
                        <a href="#" class="btn btn-warning btn-sm"><i class="bi bi-pencil-square"></i></a>
                        <a href="#" class="btn btn-danger btn-sm"><i class="bi bi-trash3-fill"></i></a>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
<!-- Modal -->
<div class="modal fade" id="modalUsuario" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="exampleModalLabel">Agregar Usuario</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <label for="nombre">nombre</label>
                    <input type="text" name="nombre" id="nombre" class="form-control">
                    <label for="apellido">apellido</label>
                    <input type="text" name="apellido" id="apellido" class="form-control">
                    <label for="cedula">cedula</label>
                    <input type="text" name="cedula" id="cedula" maxlength="13" oninput="formatearCedula(event)" placeholder="420-4106071-0" class="form-control">
                    <script>
                        function formatearCedula(event) {
                            let input = event.target;
                            let valor = input.value;
                            valor = valor.replace(/[^0-9]/g, '');
                            if (valor.length > 10) {
                                valor = valor.substring(0, 10);
                            }
                            if (valor.length <= 3) {
                                input.value = valor;
                            } else if (valor.length <= 9) {
                                input.value = valor.substring(0, 3) + '-' + valor.substring(3, 9);
                            } else {
                                input.value = valor.substring(0, 3) + '-' + valor.substring(3, 9) + '-' + valor.substring(9, 10);
                            }
                        }
                    </script>
                    <label for="telefono">telefono</label>
                    <input type="text" name="telefono" id="telefono" maxlength="12" oninput="formatearTelefono(event)" placeholder="829-901-0538" class="form-control">
                    <script>
                        function formatearTelefono(event) {
                            let input = event.target;
                            let valor = input.value;
                            valor = valor.replace(/[^0-9]/g, '');
                            if (valor.length > 10) {
                                valor = valor.substring(0, 10);
                            }
                            if (valor.length <= 3) {
                                input.value = valor;
                            } else if (valor.length <= 6) {
                                input.value = valor.substring(0, 3) + '-' + valor.substring(3, 6);
                                input.value = valor.substring(0, 3) + '-' + valor.substring(3, 6) + '-' + valor.substring(6, 10);
                            }
                        }
                    </script>
                    <label for="correo">correo</label>
                    <input type="email" name="correo" id="correo" class="form-control">
                    <label for="redes">redes sociales</label>
                    <input type="text" name="redes" id="redes" class="form-control">
                    <label for="comentario">comentario</label>
                    <textarea name="comentarios" id="comentario" class="form-control" rows="4" placeholder="Deje sus comentarios"></textarea>
                    <label for="imagen_usuario" class="form-label">Imagen</label>
                    <input type="file" name="imagen_usuario" id="imagen_usuario" class="form-control">
                    <span id="imagen_subida"></span>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-primary">Guardar</button>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

<!-- -------------------------------------------------------------------------------------------- -->
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const guardarBtn = document.querySelector(".modal-footer .btn-primary");
        const tabla = document.querySelector("table tbody");

        guardarBtn.addEventListener("click", () => {
            const nombre = document.getElementById("nombre").value.trim();
            const apellido = document.getElementById("apellido").value.trim();
            const cedula = document.getElementById("cedula").value.trim();
            const telefono = document.getElementById("telefono").value.trim();
            const correo = document.getElementById("correo").value.trim();
            const redes = document.getElementById("redes").value.trim();
            const comentario = document.getElementById("comentario").value.trim();
            const imagen = document.getElementById("imagen_usuario").files[0];

            if (!nombre || !apellido || !cedula || !telefono || !correo) {
                alert("Por favor complete todos los campos obligatorios.");
                return;
            }


            let imagenSrc = "/img/default.png";
            if (imagen) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    imagenSrc = e.target.result;
                    agregarFila(imagenSrc);
                };
                reader.readAsDataURL(imagen);
            } else {
                agregarFila(imagenSrc);
            }

            function agregarFila(imagenSrc) {

                const nuevaFila = document.createElement("tr");
                nuevaFila.innerHTML = `
                    <th scope="row">${tabla.children.length + 1}</th>
                    <td><img src="${imagenSrc}" alt="Imagen" width="40" height="40" style="object-fit: cover;"></td>
                    <td>${nombre}</td>
                    <td>${apellido}</td>
                    <td>${cedula}</td>
                    <td>${telefono}</td>
                    <td>${correo}</td>
                    <td>${redes || "N/A"}</td>
                    <td>${comentario || "Sin comentario"}</td>
                    <td>
                        <a href="#" class="btn btn-success btn-sm"><i class="bi bi-file-earmark-diff-fill"></i></a>
                        <a href="#" class="btn btn-warning btn-sm"><i class="bi bi-pencil-square"></i></a>
                        <a href="#" class="btn btn-danger btn-sm"><i class="bi bi-trash3-fill"></i></a>
                    </td>
                `;

                tabla.appendChild(nuevaFila);


                document.querySelector("form").reset();


                const modal = bootstrap.Modal.getInstance(document.getElementById("modalUsuario"));
                modal.hide();
            }
        });
    });
</script>
<script src="js/index.js"></script>
<!-- --------------------------------------------------- -->
</body>
</html>
